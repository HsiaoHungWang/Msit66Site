
@{
    ViewData["Title"] = "JsonDemo";
}

<h1>JsonDemo</h1>
<table id="table1" class="table table-bordered">
    <thead>
        <tr>
            <th>姓名</th>
            <th>年資</th>
            <th>薪水</th>
        </tr>
    </thead>
    <tbody>
      
    </tbody>
</table>
<ul id="ul1">
   
</ul>
<div id="divCard" class="row row-cols-1 row-cols-md-3 g-4">
   
</div>


@section Scripts{
    <script src="~/js/travel.js"></script>
    <script>
           const travelCard = document.querySelector('#divCard');
           const travels = spots.CommonFormat.Section;
           // console.log(travels);

           const cards = travels.map(travel=>{

                      const imgs = travel.file.img;
                      let imgUrl;
                      let imgAlt;
                if(Array.isArray(imgs)){
                     imgAlt = imgs[0]["@@description"];
                   imgUrl = imgs[0].text;
               }else{
                    imgAlt=imgs["@@description"];
                    imgUrl =imgs.text;
               }
           
              return(
                  `
                       <div class="col">
            <div class="card">
                <img src="${imgUrl}" class="card-img-top" alt="${imgAlt}">
                <div class="card-body">
                     <h5 class="card-title">${travel.stitle}</h5>
                    <p class="card-text">${travel.xbody.substring(0,100)}...</p>
                </div>
                <div class="card-footer">
                    <small class="text-body-secondary">${travel.address}</small>
                </div>
            </div>
        </div>
                  
                  `
              )
           
           });


            travelCard.innerHTML = cards.join('');

           // travels.forEach(travel=>{
           //    const imgs = travel.file.img;
           //     if(Array.isArray(imgs)){
           //          console.log(imgs[0]["@@description"]);
           //        console.log(imgs[0].text);
           //    }else{
           //         console.log(imgs["@@description"]);
           //        console.log(imgs.text);
           //    }
           // })



          
        const myUl = document.querySelector('#ul1');
        const myTb = document.querySelector('#table1>tbody');

        const emps = [{"name":"Tom","workYears":3,"salary":35000},
                     {"name":"Jack","workYears":5,"salary":40000},
                     {"name":"Mary","workYears":7,"salary":45000}];
        //[] => 透過index讀資料 emps[1] =>{"name":"Jack","workYears":5,"salary":40000}
        //{} => emps[1] => 透過物件.屬性 讀資料 emps[1].name => Jack

        // console.log(emps[0]);   {"name":"Tom","workYears":3,"salary":35000}
        // console.log(emps[0].name);Tom

        //for(let i=0;i<emps.length;i++){}

        // for(idx in emps){
        //   console.log(emps[idx]);
        // }
        // for(emp of emps){
        //    console.log(emp);
        // }

        //ES6 Array.method()
        // emps.forEach((emp, index, arrs)=>{
        //     console.log(arrs);
        //     console.log(index);
        //     console.log(emp);
        // })

       // ()=>{}
        // const docFrag = document.createDocumentFragment();
        //  emps.forEach(emp => {             
        //      // console.log(emp.name);
        //      //  console.log(emp.workYears);
        //      // console.log(emp.salary);
        //      //DOM
        //       const txtName = document.createTextNode(emp.name + "," + emp.workYears);
        //       const liName = document.createElement('li');
        //       liName.appendChild(txtName); //<li>Name</li>
        //       docFrag.appendChild(liName);

        //      //這裡的寫法不好
        //      //myUl.appendChild(liName);

        // })

        //  myUl.appendChild(docFrag);
         

        const datas = emps.map(employee=>{
            //解構賦值
            const {name, workYears, salary} = employee;
            return(
                 `<tr>
                  <td>${name}</td>
                  <td>${workYears}</td>
                  <td>${salary}</td>
                </tr>
                 `
            )
        })

         myTb.innerHTML = datas.join('');




        // const emp = {"employees":[
        //               {"name":"Tom","workYears":3,"salary":35000},
        //               {"name":"Jack","workYears":5,"salary":40000},
        //               {"name":"Mary","workYears":7,"salary":45000}
        //            ]};
        // emp => {} or [] emp.employees => []
        // emp.employees =>  emp.employees[2] =>{"name":"Mary","workYears":7,"salary":45000}
        // emp.employees[2].name => Mary
        //  console.log(emp.employees[0]); {"name":"Tom","workYears":3,"salary":35000
        //  console.log(emp.employees[0].name); Tom

        // emp.employees.forEach(emp=>{
        //       console.log(emp.name);
        //        console.log(emp.workYears);
        //       console.log(emp.salary);
        // })
    </script>
}

